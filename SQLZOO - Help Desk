--Database & questions provided by the SQLZOO Help Desk Assessment: https://sqlzoo.net/wiki/Help_Desk

--Easy 1. There are three issues that include the words "index" and "Oracle". Find the call_date for each of them.

SELECT call_date, call_ref
FROM issue
WHERE detail LIKE '%index%' 
AND detail LIKE '%Oracle%';

--Easy 2. Samantha Hall made three calls on 2017-08-14. Show the date and time for each.

SELECT i.call_date, c.first_name, c.last_name
FROM issue i
JOIN caller c
ON i.caller_id = c.caller_id
WHERE c.first_name = 'Samantha'
AND c.last_name = 'Hall'
AND i.call_date between '2017-08-14' and '2017-08-14 23:59:59';

--Easy 3. There are 500 calls in the system (roughly). Write a query that shows the number that have each status.

SELECT status, COUNT(*) AS Volume
FROM issue
GROUP BY status;

--Easy 4. Calls are not normally assigned to a manager but it does happen. How many calls have been assigned to staff who are at Manager Level?

SELECT COUNT(*) AS mlcc
FROM issue i
LEFT JOIN staff s
ON i.assigned_to = s.staff_code
WHERE s.level_code IN (SELECT level_code FROM level WHERE manager = 'Y');

--Easy 5. Show the manager for each shift. Your output should include the shift date and type; also the first and last name of the manager.

SELECT DATE(sh.shift_date), sh.shift_type, st.first_name, st.last_name
FROM shift sh
LEFT JOIN staff st
ON sh.manager = st.staff_code;
