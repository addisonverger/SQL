--Challenges provided by StrataScratch: https://platform.stratascratch.com/coding
--All answers written in MySQL

--Most Profitable Companies

SELECT profits, company
FROM forbes_global_2010_2014
ORDER BY profits DESC
LIMIT 3;

--Counting Instances in Text

WITH CTE AS (
    SELECT GROUP_CONCAT(contents SEPARATOR ' ') AS group_contents
    FROM google_file_store
)

SELECT 'bull' AS word, (LENGTH(group_contents) - LENGTH(REPLACE(group_contents, 'bull', ''))) / LENGTH('bull') AS nentry
FROM CTE
UNION
SELECT 'bear' AS word, (LENGTH(group_contents) - LENGTH(REPLACE(group_contents, 'bear', ''))) / LENGTH('bear') AS nentry
FROM CTE;

--Bikes Last Used

SELECT bike_number, MAX(end_time) AS last_used
FROM dc_bikeshare_q1_2012
GROUP BY bike_number
ORDER BY last_used DESC;
