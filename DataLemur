--Challenges provided by DataLemur: https://datalemur.com/
--All answers written in PostgreSQL

--Page With No Likes

SELECT page_id
FROM pages
WHERE page_id NOT IN (SELECT page_id FROM page_likes);

--Unfinished Parts

SELECT part, assembly_step
FROM parts_assembly
WHERE finish_date IS NULL;

--Histogram of Tweets

SELECT tweet_bucket, COUNT(*) AS users_num
FROM (
  SELECT COUNT(tweet_id) AS tweet_bucket
  FROM tweets
  WHERE EXTRACT('Year' FROM tweet_date) = 2022
  GROUP BY user_id
) tweet_bucket_counts
GROUP BY 1;

--Laptop vs. Mobile Viewership

SELECT 
  SUM(CASE WHEN device_type = 'laptop' THEN 1 ELSE 0 END) AS laptop_views,
  SUM(CASE WHEN device_type = 'tablet' OR device_type = 'phone' THEN 1 ELSE 0 END) AS laptop_views
FROM viewership;

--Data Science Skills

SELECT candidate_id
FROM candidates
WHERE skill IN ('Python', 'Tableau', 'PostgreSQL')
GROUP BY 1
HAVING COUNT(skill) = 3
ORDER BY 1 ASC;
