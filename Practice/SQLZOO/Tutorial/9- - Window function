--All resources provided by SQLZOO: https://new.sqlzoo.net/wiki/Window_functions

--1. Warming up

SELECT lastName, party, votes
FROM ge
WHERE constituency = 'S14000024' 
AND yr = 2017
ORDER BY votes DESC

--2. Who won?

SELECT party, votes, RANK() OVER (ORDER BY votes DESC)
FROM ge
WHERE constituency = 'S14000024'
AND yr = 2017
ORDER BY party

--3. PARTITION BY

SELECT yr, party, votes, RANK() OVER (PARTITION BY yr ORDER BY votes DESC)
FROM ge
WHERE constituency = 'S14000021'
